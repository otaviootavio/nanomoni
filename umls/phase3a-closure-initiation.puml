@startuml Phase3a_Closure_Initiation

!theme plain
autonumber

actor "Client" as Client
participant "Vendor API" as Vendor
database "Vendor DB\n(Redis)" as VendorDB

Client -> Vendor: POST /api/v1/vendor/channels/{channel_id}/closure-requests\nCloseChannelRequest\n(computed_id)
activate Vendor

Vendor -> VendorDB: Get PaymentChannel from computed_id
VendorDB --> Vendor: PaymentChannel

Vendor -> VendorDB: Get latest OffChainTx from computed_id
VendorDB --> Vendor: OffChainTx

Vendor -> Vendor: Validate channel & payments\n(exists, open, latest_tx found)

Vendor -> Vendor: Load vendor private key
Vendor -> Vendor: Build CloseChannelRequestPayload\nfrom latest OffChainTx

Vendor -> Vendor: Sign payload with vendor private key\n(vendor_close_signature)

@enduml
