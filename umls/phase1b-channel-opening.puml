@startuml Phase1b_Channel_Opening

!theme plain
autonumber

actor "Client" as Client
participant "Issuer API" as Issuer
database "Issuer DB\n(Redis)" as IssuerDB

Client -> Client: Choose vendor
Client -> Client: Prepare channel opening request\n(mode-specific commitment, if any)
Client -> Client: Sign request

Client -> Issuer: Open Payment Channel
activate Issuer

Issuer -> Issuer: Verify envelope and validate request
Issuer -> IssuerDB: Lock funds and create channel
IssuerDB --> Issuer: PaymentChannel

Issuer --> Client: 201 Created\nChannel opened (channel_id)
deactivate Issuer

@enduml
